# 帕神库存管理系统 · 答辩速览

## 1. 项目概述
- 前端技术栈：Vue 3 + Vite + TypeScript，UnoCSS 做样式，文件路由（unplugin-vue-router）。
- 目标：对接后端库存管理 API，提供仪表盘、商品查询、分类/供应商 CRUD、订单查询、库存审计。
- 响应规范：后端统一 `code/message/data`，`code=0` 视为成功；401 触发前端清 token 并跳转登录。

## 2. 运行与配置
- 环境变量：`VITE_API_BASE_URL`（开发常用 `http://localhost:5001/`，生产示例 `https://api.sis.tagzxia.com/`）。
- 启动：`pnpm install` → `pnpm dev`（默认 3333 端口，已自动打开）。
- 构建/检查：`pnpm build`、`pnpm lint`、`pnpm typecheck`、`pnpm test`（目前无自定义测试）。
- 登录态存储：`localStorage.sis.access_token`，路由守卫未登录直接跳 `/auth/login`。

## 3. 业务模块与页面
- 认证：`/auth/login`、`/auth/register`，登录成功写入 access_token，token 过期自动清空并重定向登录。
- 仪表盘 `/`：调用报表/预警/商品 Top5，展示今日入库/出库/调整、预警数量、近期库存操作时间线。
- 商品查询 `/products`：支持关键字、状态、分类、供应商筛选与分页。仅列表，暂无商品 CRUD。
- 分类 `/categories`：已做 CRUD。新增表单 + 行内编辑/删除，需要登录；删除受后端“分类下有商品”限制。
- 供应商 `/suppliers`：已做 CRUD。同分类，删除受“有商品引用”限制。
- 订单 `/orders`：需登录查看列表，筛选类型/状态/时间，401 自动跳转登录。
- 库存审计 `/audit`：需登录查看库存操作流水，筛选关键字/类型/日期，token 过期自动重登。
- 计划 `/plan`：历史路由，已重定向回首页。

## 4. API 对接约定
- 路径示例：`/api/categories`、`/api/suppliers`、`/api/products`、`/api/orders`、`/api/stock/operations`、`/api/reports/*`。
- 鉴权：需要权限的接口带 `Authorization: Bearer <token>`；401 由前端捕获并清理登录态。
- 分页参数：`page` 从 1 起，`size`；通用搜索用 `keyword`。
- 关键 CRUD（已对接前端）：
  - 分类：GET 列表/详情，POST 创建，PUT 更新，DELETE 删除（admin / stock_operator; 删除仅 admin）。
  - 供应商：同上（admin/purchaser/stock_operator；删除仅 admin）。

## 5. 代码结构速记
- `src/main.ts`：应用与路由初始化，公共路由守卫。
- `src/services/*`：API 客户端与各领域服务（auth/catalog/dashboard/orders/stock）。
- `src/composables/useAuth.ts`：登录状态、错误提示、统一 401 文案。
- `src/pages/*`：页面级业务逻辑；`categories`、`suppliers` 已含表单/编辑/删除；`products` 仅查询。
- `src/components/LayoutShell.vue`：顶层布局与侧边导航；`PaginationBar` 统一分页控件。

## 6. 现状与缺口
- 已完成：分类/供应商 CRUD；订单/审计列表的 401 自动跳转；仪表盘数据挂载。
- 缺口：商品 CRUD 未做；库存入/出/调整操作未接；权限矩阵仅前端基础校验，未做细粒度按钮级控制；无单元/端到端用例。

## 7. 演示话术提示
- 先注册/登录拿 token（演示 401 自动跳登录）。
- 展示分类/供应商的新增、行内编辑、删除失败场景（被后端校验拦截）。
- 展示商品筛选和库存审计列表（若 token 过期，演示自动重登）。
- 点仪表盘刷新，说明报表/预警/商品 Top 拉取逻辑与错误聚合提示。

## 8. Q&A 预案
- Q：为什么商品没有 CRUD？A：后端需求未锁定，当前聚焦字典 CRUD 与报表；可按同样模式扩展。
- Q：401 如何处理？A：服务层抛 ApiError，页面捕获 401 清 token，带 redirect 回登录，避免无感失败。
- Q：删除失败怎么办？A：后端校验关联商品/库存，前端提示原始 message，用户需先解除关联。
